define(["utils/utils","mvc/form/form-view","mvc/tool/tool-form-base"],function(a,b,c){function d(a){{var b=a.model.attributes;b.workflow,b.node}}function e(a){{var b=a.model.attributes,c=(b.inputs,b.datatypes,b.node);b.workflow,c.post_job_actions,c.output_terminals&&Object.keys(c.output_terminals)[0]}}var f=Backbone.View.extend({initialize:function(c){var d=this,e=c.node;this.form=new b(a.merge(c,{onchange:function(){a.request({type:"POST",url:Galaxy.root+"api/workflows/build_module",data:{id:e.id,type:e.type,content_id:e.content_id,inputs:d.form.data.create()},success:function(a){e.update_field_data(a)}})}})),this.form.render()}}),g=Backbone.View.extend({initialize:function(b){var d=this,e=b.node;this.form=new c(a.merge(b,{text_enable:"Set in Advance",text_disable:"Set at Runtime",narrow:!0,initial_errors:!0,cls:"ui-portlet-narrow",initialmodel:function(a,b){d._customize(b),a.resolve()},buildmodel:function(a,b){b.model.get("postchange")(a,b)},postchange:function(b,c){var f=c.model.attributes,g={tool_id:f.id,tool_version:f.version,type:"tool",inputs:$.extend(!0,{},c.data.create())};Galaxy.emit.debug("tool-form-workflow::postchange()","Sending current state.",g),a.request({type:"POST",url:Galaxy.root+"api/workflows/build_module",data:g,success:function(a){c.model.set(a.config_form),d._customize(c),c.update(a.config_form),c.errors(a.config_form),e.update_field_data(a),Galaxy.emit.debug("tool-form-workflow::postchange()","Received new model.",a),b.resolve()},error:function(a){Galaxy.emit.debug("tool-form-workflow::postchange()","Refresh request failed.",a),b.reject()}})}}))},_customize:function(b){var c=b.model.attributes;a.deepeach(c.inputs,function(b){b.type&&(-1!=["data","data_collection"].indexOf(b.type)?(b.type="hidden",b.info="Data input '"+b.name+"' ("+a.textify(b.extensions)+")",b.value={__class__:"RuntimeValue"}):b.fixed||(b.collapsible_value={__class__:"RuntimeValue"},b.is_workflow=b.options&&0==b.options.length||-1!=["integer","float"].indexOf(b.type)))}),a.deepeach(c.inputs,function(a){"conditional"==a.type&&(a.test_param.collapsible_value=void 0)}),e(b),d(b)}});return{Default:f,Tool:g}});
//# sourceMappingURL=../../../maps/mvc/workflow/workflow-forms.js.map